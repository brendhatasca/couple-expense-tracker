<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brendha & Mitchell's Expense Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Expense Tracker">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiB2aWV3Qm94PSIwIDAgMTgwIDE4MCI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojOWY3YWVhO3N0b3Atb3BhY2l0eToxIiAvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6I2VjNDg5OTtzdG9wLW9wYWNpdHk6MSIgLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgZmlsbD0idXJsKCNhKSIgcng9IjQwIi8+PHRleHQgeD0iOTAiIHk9IjEwNSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjcwIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+üí∞PC90ZXh0Pjwvc3ZnPg==">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .btn {
            transition: all 0.2s ease;
        }
        .btn:hover {
            transform: translateY(-1px);
        }
        .card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-50 to-pink-50">
    <div class="max-w-6xl mx-auto p-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">üí∞ Brendha & Mitchell's Expense Tracker</h1>
        </div>

        <!-- Input Section -->
        <div class="card bg-white rounded-xl shadow-lg p-6 mb-6">
            <div class="flex flex-col sm:flex-row gap-4 mb-4">
                <select id="personSelect" class="px-4 py-2 border rounded-lg">
                    <option value="Brendha">Brendha</option>
                    <option value="Mitchell">Mitchell</option>
                </select>
                
                <input 
                    type="text" 
                    id="expenseInput" 
                    placeholder="e.g., '$50.78 for groceries' or '$200 from mom'"
                    class="flex-1 px-4 py-2 border rounded-lg"
                />
                
                <button id="addBtn" class="btn bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">
                    ‚ûï Add
                </button>
            </div>
            
            <div class="text-sm text-gray-600">
                <p><strong>Examples:</strong></p>
                <p>‚Ä¢ "$45.50 for groceries" ‚Ä¢ "$800 rent payment" ‚Ä¢ "$150 from mom" ‚Ä¢ "$25.99 for utilities"</p>
            </div>
        </div>

        <!-- Month Selector -->
        <div class="card bg-white rounded-xl shadow-lg p-6 mb-6">
            <div class="flex flex-col sm:flex-row items-center gap-4">
                <span class="text-purple-600">üìÖ</span>
                <select id="monthSelect" class="px-4 py-2 border rounded-lg">
                    <!-- Will be populated by JavaScript -->
                </select>
                
                <button id="exportBtn" class="btn bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                    üíæ Export CSV
                </button>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            <div class="card bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <span class="text-red-500 text-2xl">üìâ</span>
                    <div>
                        <p class="text-gray-600 text-sm">Total Expenses</p>
                        <p id="totalExpenses" class="text-2xl font-bold text-gray-800">$0.00</p>
                    </div>
                </div>
            </div>

            <div class="card bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <span class="text-green-500 text-2xl">üìà</span>
                    <div>
                        <p class="text-gray-600 text-sm">Total Income</p>
                        <p id="totalIncome" class="text-2xl font-bold text-gray-800">$0.00</p>
                    </div>
                </div>
            </div>

            <div class="card bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <span class="text-blue-500 text-2xl">üí∞</span>
                    <div>
                        <p class="text-gray-600 text-sm">Net Balance</p>
                        <p id="netBalance" class="text-2xl font-bold text-gray-800">$0.00</p>
                    </div>
                </div>
            </div>

            <div class="card bg-white rounded-xl shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <span class="text-purple-500 text-2xl">üë•</span>
                    <div>
                        <p class="text-gray-600 text-sm">Balance Due</p>
                        <p id="balanceDue" class="text-lg font-bold text-gray-800">Even</p>
                        <p id="whoOwes" class="text-xs text-gray-500"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Individual Spending -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="card bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üë©‚Äçüíº Brendha's Spending</h3>
                <p id="brendhaSpending" class="text-3xl font-bold text-purple-600">$0.00</p>
            </div>
            
            <div class="card bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üë®‚Äçüíº Mitchell's Spending</h3>
                <p id="mitchellSpending" class="text-3xl font-bold text-blue-600">$0.00</p>
            </div>
        </div>

        <!-- Category Breakdowns -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="card bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üìä Expense Categories</h3>
                <div id="expenseCategories">
                    <p class="text-gray-500">No expenses recorded this month</p>
                </div>
            </div>

            <div class="card bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üí∞ Income Sources</h3>
                <div id="incomeSources">
                    <p class="text-gray-500">No income recorded this month</p>
                </div>
            </div>
        </div>

        <!-- Recent Entries -->
        <div class="card bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">üìù Recent Entries</h3>
            <div id="entriesList" class="max-h-96 overflow-y-auto">
                <p class="text-gray-500 text-center py-8">No entries yet. Add your first expense above!</p>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let entries = [];
        let currentMonth = new Date().toISOString().slice(0, 7);
        let editingEntry = null;

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('expenseEntries');
            if (saved) {
                entries = JSON.parse(saved);
            }
            updateUI();
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('expenseEntries', JSON.stringify(entries));
        }

        // Categorize expenses
        function categorizeExpense(description) {
            const desc = description.toLowerCase();
            if (desc.includes('groceries') || desc.includes('food') || desc.includes('grocery')) return 'Groceries';
            if (desc.includes('rent')) return 'Rent';
            if (desc.includes('utilities') || desc.includes('electric') || desc.includes('water') || desc.includes('gas')) return 'Utilities';
            if (desc.includes('transport') || desc.includes('uber') || desc.includes('car')) return 'Transportation';
            if (desc.includes('entertainment') || desc.includes('movie') || desc.includes('restaurant')) return 'Entertainment';
            return 'Miscellaneous';
        }

        // Parse input text
        function parseInput(text, person) {
            const amountMatch = text.match(/\$?(\d+(?:\.\d{2})?)/);
            if (!amountMatch) return null;

            const amount = parseFloat(amountMatch[1]);
            const isIncome = text.toLowerCase().includes('from') || text.toLowerCase().includes('income');
            
            let source = '';
            if (isIncome) {
                const fromMatch = text.match(/from\s+(\w+(?:\s+\w+)*)/i);
                if (fromMatch) {
                    source = fromMatch[1];
                } else if (text.toLowerCase().includes('mom')) source = 'Mom';
                else if (text.toLowerCase().includes('dad')) source = 'Dad';
                else if (text.toLowerCase().includes('paycheck')) source = 'Paycheck';
                else source = 'Other';
            }

            const category = isIncome ? 'Income' : categorizeExpense(text);

            return {
                id: Date.now(),
                amount,
                description: text,
                category,
                source,
                isIncome,
                person,
                date: new Date().toISOString().split('T')[0],
                month: new Date().toISOString().slice(0, 7)
            };
        }

        // Add new entry
        function addEntry() {
            const inputText = document.getElementById('expenseInput').value;
            const person = document.getElementById('personSelect').value;
            
            if (!inputText.trim()) {
                alert('Please enter an expense or income');
                return;
            }

            const parsed = parseInput(inputText, person);
            if (parsed) {
                entries.push(parsed);
                document.getElementById('expenseInput').value = '';
                saveData();
                updateUI();
            } else {
                alert('Please enter a valid amount and description (e.g., "$50.78 for groceries")');
            }
        }

        // Delete entry
        function deleteEntry(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                entries = entries.filter(entry => entry.id !== id);
                saveData();
                updateUI();
            }
        }

        // Start editing entry
        function startEdit(id) {
            const entry = entries.find(e => e.id === id);
            if (!entry) return;
            
            editingEntry = id;
            const entryElement = document.querySelector(`[data-id="${id}"]`);
            const descElement = entryElement.querySelector('.description');
            
            descElement.innerHTML = `
                <input type="text" value="${entry.description}" class="flex-1 px-3 py-1 border rounded edit-input" />
                <button onclick="saveEdit(${id})" class="bg-green-500 text-white px-2 py-1 rounded text-sm hover:bg-green-600 ml-2">‚úÖ</button>
                <button onclick="cancelEdit(${id})" class="bg-gray-500 text-white px-2 py-1 rounded text-sm hover:bg-gray-600 ml-1">‚ùå</button>
            `;
        }

        // Save edit
        function saveEdit(id) {
            const entryElement = document.querySelector(`[data-id="${id}"]`);
            const input = entryElement.querySelector('.edit-input');
            const newText = input.value;
            
            const person = entries.find(e => e.id === id).person;
            const parsed = parseInput(newText, person);
            
            if (parsed) {
                const entryIndex = entries.findIndex(e => e.id === id);
                const originalEntry = entries[entryIndex];
                entries[entryIndex] = { ...parsed, id: originalEntry.id, date: originalEntry.date, month: originalEntry.month };
                editingEntry = null;
                saveData();
                updateUI();
            } else {
                alert('Please enter a valid amount and description');
            }
        }

        // Cancel edit
        function cancelEdit(id) {
            editingEntry = null;
            updateUI();
        }

        // Get monthly data
        function getMonthlyData(month) {
            return entries.filter(entry => entry.month === month);
        }

        // Calculate totals
        function calculateTotals(monthEntries) {
            const brendhaExpenses = monthEntries
                .filter(e => e.person === 'Brendha' && !e.isIncome)
                .reduce((sum, e) => sum + e.amount, 0);
            
            const mitchellExpenses = monthEntries
                .filter(e => e.person === 'Mitchell' && !e.isIncome)
                .reduce((sum, e) => sum + e.amount, 0);

            const totalExpenses = brendhaExpenses + mitchellExpenses;
            const totalIncome = monthEntries
                .filter(e => e.isIncome)
                .reduce((sum, e) => sum + e.amount, 0);

            const difference = brendhaExpenses - mitchellExpenses;
            const owedAmount = Math.abs(difference) / 2;

            return {
                brendhaExpenses,
                mitchellExpenses,
                totalExpenses,
                totalIncome,
                difference,
                owedAmount,
                whoOwes: difference > 0 ? 'Mitchell owes Brendha' : 'Brendha owes Mitchell'
            };
        }

        // Get category breakdown
        function getCategoryBreakdown(monthEntries) {
            const breakdown = {};
            monthEntries.forEach(entry => {
                if (!breakdown[entry.category]) {
                    breakdown[entry.category] = 0;
                }
                breakdown[entry.category] += entry.amount;
            });
            return breakdown;
        }

        // Update UI
        function updateUI() {
            updateMonthSelector();
            const monthEntries = getMonthlyData(currentMonth);
            const totals = calculateTotals(monthEntries);
            
            // Update summary cards
            document.getElementById('totalExpenses').textContent = `$${totals.totalExpenses.toFixed(2)}`;
            document.getElementById('totalIncome').textContent = `$${totals.totalIncome.toFixed(2)}`;
            document.getElementById('netBalance').textContent = `$${(totals.totalIncome - totals.totalExpenses).toFixed(2)}`;
            document.getElementById('balanceDue').textContent = totals.owedAmount > 0 ? `$${totals.owedAmount.toFixed(2)}` : 'Even';
            document.getElementById('whoOwes').textContent = totals.owedAmount > 0 ? totals.whoOwes : '';
            
            // Update individual spending
            document.getElementById('brendhaSpending').textContent = `$${totals.brendhaExpenses.toFixed(2)}`;
            document.getElementById('mitchellSpending').textContent = `$${totals.mitchellExpenses.toFixed(2)}`;
            
            // Update categories
            updateCategories(monthEntries);
            updateEntries(monthEntries);
        }

        // Update month selector
        function updateMonthSelector() {
            const months = [...new Set(entries.map(e => e.month))].sort().reverse();
            const selector = document.getElementById('monthSelect');
            
            if (months.length === 0) {
                selector.innerHTML = `<option value="${currentMonth}">${new Date(currentMonth + '-01').toLocaleDateString('en-US', { year: 'numeric', month: 'long' })}</option>`;
            } else {
                selector.innerHTML = months.map(month => 
                    `<option value="${month}" ${month === currentMonth ? 'selected' : ''}>
                        ${new Date(month + '-01').toLocaleDateString('en-US', { year: 'numeric', month: 'long' })}
                    </option>`
                ).join('');
            }
        }

        // Update categories
        function updateCategories(monthEntries) {
            const expenseEntries = monthEntries.filter(e => !e.isIncome);
            const incomeEntries = monthEntries.filter(e => e.isIncome);
            
            const expenseBreakdown = getCategoryBreakdown(expenseEntries);
            const incomeBreakdown = getCategoryBreakdown(incomeEntries);
            
            // Update expense categories
            const expenseCategoriesEl = document.getElementById('expenseCategories');
            if (Object.keys(expenseBreakdown).length === 0) {
                expenseCategoriesEl.innerHTML = '<p class="text-gray-500">No expenses recorded this month</p>';
            } else {
                expenseCategoriesEl.innerHTML = Object.entries(expenseBreakdown)
                    .map(([category, amount]) => 
                        `<div class="flex justify-between items-center py-2 border-b">
                            <span class="text-gray-700">${category}</span>
                            <span class="font-semibold text-red-600">$${amount.toFixed(2)}</span>
                        </div>`
                    ).join('');
            }
            
            // Update income sources
            const incomeSourcesEl = document.getElementById('incomeSources');
            if (Object.keys(incomeBreakdown).length === 0) {
                incomeSourcesEl.innerHTML = '<p class="text-gray-500">No income recorded this month</p>';
            } else {
                incomeSourcesEl.innerHTML = Object.entries(incomeBreakdown)
                    .map(([source, amount]) => 
                        `<div class="flex justify-between items-center py-2 border-b">
                            <span class="text-gray-700">${source}</span>
                            <span class="font-semibold text-green-600">$${amount.toFixed(2)}</span>
                        </div>`
                    ).join('');
            }
        }

        // Update entries list
        function updateEntries(monthEntries) {
            const entriesEl = document.getElementById('entriesList');
            
            if (monthEntries.length === 0) {
                entriesEl.innerHTML = '<p class="text-gray-500 text-center py-8">No entries for this month yet</p>';
                return;
            }
            
            entriesEl.innerHTML = monthEntries.slice().reverse().map(entry => 
                `<div data-id="${entry.id}" class="flex justify-between items-center py-3 border-b hover:bg-gray-50">
                    <div class="flex-1 description">
                        <p class="font-medium text-gray-800">${entry.description}</p>
                        <p class="text-sm text-gray-600">
                            ${entry.person} ‚Ä¢ ${entry.category} ‚Ä¢ ${entry.date}${entry.source ? ` ‚Ä¢ from ${entry.source}` : ''}
                        </p>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="font-bold ${entry.isIncome ? 'text-green-600' : 'text-red-600'}">
                            ${entry.isIncome ? '+' : '-'}$${entry.amount.toFixed(2)}
                        </span>
                        <div class="flex gap-1">
                            <button onclick="startEdit(${entry.id})" class="bg-blue-500 text-white px-2 py-1 rounded text-sm hover:bg-blue-600" title="Edit">‚úèÔ∏è</button>
                            <button onclick="deleteEntry(${entry.id})" class="bg-red-500 text-white px-2 py-1 rounded text-sm hover:bg-red-600" title="Delete">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>`
            ).join('');
        }

        // Export to CSV
        function exportToCSV() {
            const monthEntries = getMonthlyData(currentMonth);
            if (monthEntries.length === 0) {
                alert('No entries for this month to export');
                return;
            }

            const headers = ['Date', 'Person', 'Amount', 'Category', 'Description', 'Source', 'Type'];
            const csvData = monthEntries.map(entry => [
                entry.date,
                entry.person,
                entry.amount.toFixed(2),
                entry.category,
                `"${entry.description}"`,
                entry.source || '',
                entry.isIncome ? 'Income' : 'Expense'
            ]);

            const csvContent = [headers, ...csvData].map(row => row.join(',')).join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `expenses_${currentMonth}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            
            document.getElementById('addBtn').addEventListener('click', addEntry);
            document.getElementById('expenseInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addEntry();
            });
            
            document.getElementById('monthSelect').addEventListener('change', function(e) {
                currentMonth = e.target.value;
                updateUI();
            });
            
            document.getElementById('exportBtn').addEventListener('click', exportToCSV);
        });
    </script>
</body>
</html>
